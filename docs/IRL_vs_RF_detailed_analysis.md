# IRL vs RF (Case2) 詳細分析レポート

Nova プロジェクト、Cross-Temporal 評価 10 パターン比較

---

## 1. 分析概要

### 1.1 目的

IRL（逆強化学習）と RF（ランダムフォレスト Case2）のレビュアー継続予測における性能差を、
**開発者レベル**で詳細に分析し、各モデルの得意・不得意領域を特定する。

### 1.2 評価設定

| 項目         | 内容                                           |
| ------------ | ---------------------------------------------- |
| プロジェクト | Nova (OpenStack)                               |
| 訓練年       | 2021 年                                        |
| 評価年       | 2023 年                                        |
| パターン数   | 10 パターン（訓練期間 × 評価期間の組み合わせ） |

### 1.3 モデル仕様

| モデル   | 特徴量数 | 主な特徴量                                           | 閾値                               |
| -------- | -------- | ---------------------------------------------------- | ---------------------------------- |
| IRL      | 26       | 活動量、承諾率、プロジェクト関与度、レビュー傾向など | 訓練データで最適化（0.456〜0.477） |
| RF Case2 | 2        | history_request_count, history_acceptance_rate       | 0.5（固定）                        |

### 1.4 ラベル定義

- **継続（1）**: 評価期間で 1 件以上レビューを承諾
- **離脱（0）**: 評価期間でレビュー承諾が 0 件

---

## 2. 10 パターン一覧

| #   | パターン      | 訓練期間  | 評価期間  | 時間的距離 |
| --- | ------------- | --------- | --------- | ---------- |
| 1   | 0-3m → 0-3m   | 0-3 ヶ月  | 0-3 ヶ月  | 0（同一）  |
| 2   | 0-3m → 3-6m   | 0-3 ヶ月  | 3-6 ヶ月  | 1          |
| 3   | 0-3m → 6-9m   | 0-3 ヶ月  | 6-9 ヶ月  | 2          |
| 4   | 0-3m → 9-12m  | 0-3 ヶ月  | 9-12 ヶ月 | 3（最遠）  |
| 5   | 3-6m → 3-6m   | 3-6 ヶ月  | 3-6 ヶ月  | 0（同一）  |
| 6   | 3-6m → 6-9m   | 3-6 ヶ月  | 6-9 ヶ月  | 1          |
| 7   | 3-6m → 9-12m  | 3-6 ヶ月  | 9-12 ヶ月 | 2          |
| 8   | 6-9m → 6-9m   | 6-9 ヶ月  | 6-9 ヶ月  | 0（同一）  |
| 9   | 6-9m → 9-12m  | 6-9 ヶ月  | 9-12 ヶ月 | 1          |
| 10  | 9-12m → 9-12m | 9-12 ヶ月 | 9-12 ヶ月 | 0（同一）  |

---

## 3. 全体性能比較

### 3.1 パターン別 F1・AUC スコア

| パターン      | IRL F1    | RF F1 | F1 勝者 | IRL AUC   | RF AUC    | AUC 勝者 |
| ------------- | --------- | ----- | ------- | --------- | --------- | -------- |
| 0-3m → 0-3m   | 0.591     | 0.565 | **IRL** | 0.717     | 0.730     | RF       |
| 0-3m → 3-6m   | 0.700     | 0.622 | **IRL** | 0.823     | 0.836     | RF       |
| 0-3m → 6-9m   | **0.774** | 0.649 | **IRL** | **0.910** | 0.780     | **IRL**  |
| 0-3m → 9-12m  | 0.647     | 0.615 | **IRL** | 0.734     | 0.805     | RF       |
| 3-6m → 3-6m   | 0.645     | 0.625 | **IRL** | 0.820     | 0.809     | **IRL**  |
| 3-6m → 6-9m   | 0.636     | 0.786 | RF      | **0.894** | 0.833     | **IRL**  |
| 3-6m → 9-12m  | 0.560     | 0.690 | RF      | 0.802     | 0.797     | **IRL**  |
| 6-9m → 6-9m   | 0.581     | 0.759 | RF      | 0.785     | **0.933** | RF       |
| 6-9m → 9-12m  | **0.706** | 0.545 | **IRL** | 0.832     | 0.780     | **IRL**  |
| 9-12m → 9-12m | 0.727     | 0.688 | **IRL** | 0.693     | **0.900** | RF       |
| **平均**      | **0.657** | 0.654 |         | 0.801     | **0.820** |          |

**勝敗サマリー:**

- F1 スコア: **IRL 7 勝 / RF 3 勝**
- AUC-ROC: **IRL 5 勝 / RF 5 勝**

### 3.2 予測一致・不一致の内訳（10 パターン合計: 418 件）

| 分類         | 件数 | 割合  | 説明                     |
| ------------ | ---- | ----- | ------------------------ |
| 両方正解     | 264  | 63.2% | IRL・RF 両方が正しく予測 |
| 両方不正解   | 58   | 13.9% | IRL・RF 両方が誤って予測 |
| IRL のみ正解 | 46   | 11.0% | IRL が当てて RF が外した |
| RF のみ正解  | 50   | 12.0% | RF が当てて IRL が外した |

---

## 4. パターン別勝敗分析

### 4.1 パターン別の IRL vs RF 勝敗

| パターン      | IRL のみ正解 | RF のみ正解 | 両方正解 | 両方不正解 | IRL 勝率  |
| ------------- | ------------ | ----------- | -------- | ---------- | --------- |
| 0-3m → 6-9m   | 5            | 1           | 28       | 5          | **83.3%** |
| 0-3m → 3-6m   | 8            | 3           | 32       | 9          | **72.7%** |
| 0-3m → 9-12m  | 4            | 2           | 20       | 9          | **66.7%** |
| 0-3m → 0-3m   | 8            | 6           | 32       | 11         | 57.1%     |
| 3-6m → 3-6m   | 6            | 6           | 35       | 5          | 50.0%     |
| 6-9m → 9-12m  | 5            | 5           | 21       | 4          | 50.0%     |
| 9-12m → 9-12m | 7            | 9           | 17       | 2          | 43.8%     |
| 3-6m → 9-12m  | 1            | 4           | 23       | 7          | 20.0%     |
| 3-6m → 6-9m   | 1            | 5           | 30       | 3          | 16.7%     |
| 6-9m → 6-9m   | 1            | 9           | 26       | 3          | **10.0%** |

### 4.2 訓練期間別分析

| 訓練期間 | IRL のみ正解 | RF のみ正解 | IRL 勝率  | 傾向       |
| -------- | ------------ | ----------- | --------- | ---------- |
| 0-3m     | 25           | 12          | **67.6%** | IRL 圧倒的 |
| 3-6m     | 8            | 15          | 34.8%     | RF 優位    |
| 6-9m     | 6            | 14          | 30.0%     | RF 優位    |
| 9-12m    | 7            | 9           | 43.8%     | ほぼ互角   |

### 4.3 評価期間別分析

| 評価期間 | IRL のみ正解 | RF のみ正解 | IRL 勝率  | 傾向         |
| -------- | ------------ | ----------- | --------- | ------------ |
| 0-3m     | 8            | 6           | 57.1%     | IRL やや有利 |
| 3-6m     | 14           | 9           | **60.9%** | IRL 有利     |
| 6-9m     | 7            | 15          | 31.8%     | RF 有利      |
| 9-12m    | 17           | 20          | 45.9%     | ほぼ互角     |

### 4.4 同一期間 vs 異なる期間

| 条件                     | IRL のみ正解 | RF のみ正解 | IRL 勝率  |
| ------------------------ | ------------ | ----------- | --------- |
| 同一期間（train=eval）   | 22           | 30          | 42.3%     |
| 異なる期間（train≠eval） | 24           | 20          | **54.5%** |

### 4.5 時間的距離別分析

| 距離          | IRL のみ正解 | RF のみ正解 | IRL 勝率  | 傾向         |
| ------------- | ------------ | ----------- | --------- | ------------ |
| 0（同一期間） | 22           | 30          | 42.3%     | RF 有利      |
| 1（隣接期間） | 14           | 13          | 51.9%     | ほぼ互角     |
| 2             | 6            | 5           | 54.5%     | IRL やや有利 |
| 3（最遠）     | 4            | 2           | **66.7%** | IRL 有利     |

---

## 5. 開発者レベル分析

### 5.1 開発者 × パターン勝敗マトリクス

凡例: I=IRL のみ正解, R=RF のみ正解, ○=両方正解, ×=両方不正解

差がある開発者（35 人/59 人）のみ表示:

| 開発者                      | 0-3m→0-3m | 0-3m→3-6m | 0-3m→6-9m | 0-3m→9-12m | 3-6m→3-6m | 3-6m→6-9m | 3-6m→9-12m | 6-9m→6-9m | 6-9m→9-12m | 9-12m→9-12m | IRL 勝 | RF 勝 |
| --------------------------- | --------- | --------- | --------- | ---------- | --------- | --------- | ---------- | --------- | ---------- | ----------- | ------ | ----- |
| aleksey.stupnikov           | I         | I         | I         | R          | I         | ○         | ×          | ○         | ×          | I           | **5**  | 1     |
| openstack-ci@storpool.com   | I         | I         | I         | I          | ○         | ○         | ○          | ○         | ○          | R           | **4**  | 1     |
| panhongyin                  | ×         | ×         | ○         | ×          | I         | R         | I          | R         | I          | I           | **4**  | 2     |
| ratailor                    | ○         | ×         | ×         | ○          | I         | I         | ×          | R         | I          | ○           | **3**  | 1     |
| tobias.urdin                | R         | I         | I         | I          | ○         | ○         | ○          | ○         | ○          | R           | **3**  | 2     |
| auniyal                     | I         | ○         | ○         | ○          | I         | ○         | ○          | ○         | ○          | ○           | **2**  | 0     |
| jichenjc                    | I         | I         | -         | -          | ○         | -         | -          | -         | -          | -           | **2**  | 0     |
| john.garbutt                | ○         | ×         | ○         | ×          | ○         | ×         | ○          | ×         | I          | I           | **2**  | 0     |
| noonedeadpunk               | ○         | ○         | I         | I          | ○         | ○         | ○          | ○         | ○          | ○           | **2**  | 0     |
| nova_hyperv_ci              | I         | I         | -         | -          | ○         | -         | -          | -         | -          | -           | **2**  | 0     |
| jay                         | ○         | ○         | ○         | ×          | ○         | ○         | ×          | R         | I          | I           | **2**  | 1     |
| maksim.malchuk              | ×         | ○         | ○         | ×          | ○         | ○         | ×          | R         | I          | I           | **2**  | 1     |
| rene.ribaud                 | ×         | ○         | I         | I          | ○         | ○         | ○          | ○         | ○          | R           | **2**  | 1     |
| openstack@lightbitslabs.com | I         | I         | ○         | ○          | ○         | ○         | ○          | R         | R          | R           | **2**  | 3     |
| mlnx-openstack-ci           | R         | I         | R         | R          | I         | R         | R          | R         | R          | R           | **2**  | **8** |
| bartosz                     | ○         | I         | ○         | ○          | ○         | ○         | ○          | ○         | ○          | ○           | 1      | 0     |
| christian.rohmann           | -         | ○         | ○         | ×          | ○         | ○         | ×          | ○         | ×          | I           | 1      | 0     |
| hejie.xu                    | I         | -         | -         | -          | -         | -         | -          | -         | -          | -           | 1      | 0     |
| kchamart                    | ×         | ×         | ×         | ×          | ×         | ×         | ×          | ×         | ×          | I           | 1      | 0     |
| sahid.ferdjaoui             | ×         | ○         | -         | -          | I         | -         | -          | -         | -          | -           | 1      | 0     |
| wangzihao                   | ×         | ○         | ×         | ×          | ×         | ○         | ○          | I         | ○          | ×           | 1      | 0     |
| emc.scaleio.ci              | I         | ×         | -         | -          | R         | -         | -          | -         | -          | -           | 1      | 1     |
| hongda.xun                  | ○         | ×         | ○         | ○          | ×         | ○         | ○          | ○         | ○          | R           | 0      | 1     |
| lyarwood                    | ×         | ×         | -         | -          | R         | -         | -          | -         | -          | -           | 0      | 1     |
| markgoddard86               | ○         | ○         | ○         | ○          | ○         | ○         | ○          | ○         | ○          | R           | 0      | 1     |
| takanattie                  | ×         | ○         | ×         | ×          | ○         | ×         | ×          | ×         | R          | ×           | 0      | 1     |
| zhangbailin                 | R         | -         | -         | -          | -         | -         | -          | -         | -          | -           | 0      | 1     |
| kvmpower                    | R         | R         | -         | -          | ×         | -         | -          | -         | -          | -           | 0      | 2     |
| pierre-samuel.le-stang      | R         | R         | -         | -          | ○         | -         | -          | -         | -          | -           | 0      | 2     |
| dms                         | ○         | ○         | ○         | ○          | R         | R         | R          | ○         | ○          | ○           | 0      | **3** |
| juliaashleykreger           | ○         | ○         | ○         | ○          | ○         | ○         | ○          | R         | R          | R           | 0      | **3** |
| kajinamit                   | ○         | ○         | ○         | ○          | ○         | ○         | ○          | R         | R          | R           | 0      | **3** |
| kinpaa                      | R         | R         | -         | -          | R         | -         | -          | -         | -          | -           | 0      | **3** |
| melwittt                    | ○         | ○         | ○         | ○          | R         | R         | R          | ○         | ○          | ○           | 0      | **3** |
| notartom                    | ○         | ○         | ○         | ○          | R         | R         | R          | R         | ×          | ○           | 0      | **4** |

### 5.2 開発者タイプ別サマリー

| 分類                         | 人数      | 代表例                                       |
| ---------------------------- | --------- | -------------------------------------------- |
| IRL が有利（IRL 勝 > RF 勝） | **19 人** | aleksey.stupnikov, openstack-ci@storpool.com |
| RF が有利（RF 勝 > IRL 勝）  | **15 人** | mlnx-openstack-ci, notartom                  |
| 互角（IRL 勝 = RF 勝）       | 1 人      | emc.scaleio.ci                               |

---

## 6. 特徴的な開発者の詳細分析

### 6.1 IRL が強い開発者: aleksey.stupnikov@gmail.com

| 項目       | 値         |
| ---------- | ---------- |
| 履歴依頼数 | 82 件      |
| 履歴承諾率 | 3.7%       |
| IRL 勝ち   | 5 パターン |
| RF 勝ち    | 1 パターン |

**特徴:**

- 低承諾率だが中程度の活動量
- 0-3m 訓練パターンで一貫して IRL が正解
- RF は承諾率 3.7%を「継続」と誤判定（閾値 50%より低いが 0%ではない）
- IRL は他の特徴量も考慮して離脱を正しく予測

### 6.2 RF が強い開発者: mlnx-openstack-ci@dev.mellanox.co.il

| 項目       | 値         |
| ---------- | ---------- |
| 履歴依頼数 | 407 件     |
| 履歴承諾率 | 0%         |
| IRL 勝ち   | 2 パターン |
| RF 勝ち    | 8 パターン |

**特徴:**

- CI ボット（自動化システム）
- 承諾率 0%で大量の依頼を受けるが基本的に全拒否
- 3-6m 期間だけ 1 件承諾があり「継続」ラベル → IRL 勝ち
- その他の期間は「離脱」ラベル → RF 勝ち（承諾率 0%ルールが有効）

**IRL の 2 勝の内訳:**
| パターン | IRL 確率 | 閾値 | 差 | 真値 |
|---------|--------|------|-----|------|
| 0-3m→3-6m | 0.4627 | 0.4562 | +0.0065 | 継続 |
| 3-6m→3-6m | 0.4715 | 0.4714 | **+0.0001** | 継続 |

→ 閾値との差がわずか 0.0001〜0.0065 の境界ケース。「IRL が特別な洞察を持っている」というより「閾値最適化の結果」

### 6.3 パターン変動型: panhongyin@yovole.com

| 項目       | 値         |
| ---------- | ---------- |
| IRL 勝ち   | 4 パターン |
| RF 勝ち    | 2 パターン |
| 両方不正解 | 3 パターン |

**特徴:**

- 行動パターンが期間によって大きく変動
- IRL は後期パターン（6-9m 以降）で強い
- RF は中期（3-6m→6-9m）で正解
- 両方とも予測が難しい開発者

---

## 7. 考察

### 7.1 IRL の強み

| 条件           | IRL 勝率  | 説明                           |
| -------------- | --------- | ------------------------------ |
| 0-3m 訓練      | **67.6%** | 早期データのノイズを上手く処理 |
| 異なる期間     | **54.5%** | 時系列汎化能力が高い           |
| 距離 3（最遠） | **66.7%** | 長期予測に強い                 |
| 承諾率 0-5%    | 高い      | 微妙なケースを多特徴量で判断   |

**IRL が有効なケース:**

1. 訓練データが早期（0-3m）しかない場合
2. 長期予測（6 ヶ月先以上）が必要な場合
3. 承諾率が微妙（0%ではないが低い）な開発者

### 7.2 RF の強み

| 条件      | RF 勝率   | 説明                   |
| --------- | --------- | ---------------------- |
| 同一期間  | **57.7%** | 同一分布での予測に強い |
| 6-9m 訓練 | **70.0%** | 安定期のデータで十分   |
| 承諾率 0% | 高い      | 単純ルールで検出可能   |

**RF が有効なケース:**

1. 訓練と評価が同じ期間の場合
2. 安定期（3-6m 以降）のデータがある場合
3. CI ボットなど明確なパターンの開発者

### 7.3 距離と勝率の関係（重要な発見）

```
距離0（同一期間）: IRL勝率 42.3%  → RFが有利
距離1（隣接期間）: IRL勝率 51.9%  → ほぼ互角
距離2          : IRL勝率 54.5%  → IRLやや有利
距離3（最遠）   : IRL勝率 66.7%  → IRL有利
```

**解釈:** 訓練 → 評価の時間的距離が離れるほど、IRL の 26 特徴量による複雑なパターン認識が有効になる。RF の 2 特徴量ルールは時間経過で劣化する。

---

## 8. 実用的提言

### 8.1 モデル選択ガイドライン

| シナリオ                    | 推奨モデル | 理由                  |
| --------------------------- | ---------- | --------------------- |
| 長期予測（6 ヶ月先〜）      | **IRL**    | 時系列汎化能力が高い  |
| 短期・同時点予測            | **RF**     | シンプルで十分な精度  |
| 早期データのみ              | **IRL**    | ノイズ耐性が高い      |
| 安定期データあり            | **RF**     | 単純ルールで高精度    |
| CI ボット検出               | **RF**     | 承諾率 0%ルールが有効 |
| 微妙なケース（承諾率 0-5%） | **IRL**    | 多特徴量で判断        |

### 8.2 ハイブリッド戦略

1. **承諾率で分岐:**

   - 0%: RF 予測を採用
   - 0-5%: IRL 予測を採用
   - 5%以上: 両モデルの多数決

2. **期間で分岐:**
   - 同一期間予測: RF
   - 異なる期間予測: IRL

---

## 9. 結論

### 9.1 主要な発見

1. **F1 スコアでは IRL が優勢（7 勝 3 敗）、AUC は互角（5 勝 5 敗）**
2. **時間的距離が離れるほど IRL が有利**（距離 3 で勝率 66.7%）
3. **0-3m 訓練では IRL が圧倒的**（勝率 67.6%）
4. **同一期間予測では RF が有利**（勝率 57.7%）
5. **開発者の 35/59 人（59%）で予測差異が発生**

### 9.2 各モデルの位置づけ

| モデル   | 適用領域                           | 計算コスト | 解釈性 |
| -------- | ---------------------------------- | ---------- | ------ |
| IRL      | 長期予測、早期データ、複雑なケース | 高         | 低     |
| RF Case2 | 短期予測、安定データ、単純なケース | **低**     | **高** |

### 9.3 今後の課題

1. ハイブリッドモデルの実装と評価
2. 他プロジェクト（Android, Chromium, Qt）での検証
3. 特徴量重要度に基づく IRL の改善
