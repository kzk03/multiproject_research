# 過去承諾率パラドックスの詳細分析

## 問題の発見

レビュアー属性別の分析で、以下の興味深い現象が観察されました：

**過去の承諾率が高いレビュアー（High/Very High: 50%以上）が、評価期間では極めて低い承諾率（25%）を示す**

これは直感に反する現象であり、詳細な調査を行いました。

---

## 主要な発見

### 1. 承諾率の劇的な低下

| 過去承諾率カテゴリ | 過去承諾率（平均） | 評価期間承諾率（平均） | 低下幅 | サンプル数 |
|------------------|------------------|---------------------|--------|----------|
| Low (<30%) | 0.091 | 0.080 | **-0.011** | 636 |
| Medium (30-50%) | 0.364 | 0.202 | **-0.162** | 100 |
| High (50-70%) | 0.633 | 0.444 | **-0.189** | 32 |
| **Very High (>70%)** | **0.714** | **0.047** | **-0.667** | 16 |

**驚くべき観察:**
- Very Highカテゴリで**承諾率が71.4% → 4.7%に激減**（-66.7%ポイント）
- Highカテゴリでも**63.3% → 44.4%に低下**（-18.9%ポイント）
- 一方、Lowカテゴリはほぼ変化なし（-1.1%ポイント）

### 2. サンプルサイズと経験の違い

| カテゴリ | サンプル数 | 過去レビュー数（平均） | 評価期間レビュー数（平均） |
|---------|-----------|-------------------|----------------------|
| Low (<30%) | **636** | **188.9** | **16.5** |
| Medium (30-50%) | 100 | 184.1 | 12.7 |
| High (50-70%) | **32** | **4.0** | **0.6** |
| Very High (>70%) | **16** | **7.0** | **6.2** |

**重要な発見:**
- **High/Very Highカテゴリは極めて少ない（合計48名、全体の6.1%）**
- **過去レビュー数が極端に少ない（4-7件）**
- Lowカテゴリは188.9件と圧倒的に多い

### 3. 統計的安定性の問題

#### Very Highカテゴリの詳細

**過去承諾率の分布:**
- すべてのレビュアーが**exactly 0.714**（5/7件承諾）
- これは、7件のレビュー依頼のうち5件を承諾したパターン
- **単一のパターンのみ**で構成されている

**評価期間の承諾率:**
- 平均: 0.047
- 中央値: **0.000**（半数以上が0件承諾）
- 範囲: 0.000 - 0.188

**解釈:**
- **過去7件という少ないサンプルでは、偶然高い承諾率になった可能性が高い**
- 評価期間で「真の承諾率」（実は低い）が現れた
- これは**小数の法則（Law of Small Numbers）**の典型例

---

## 個別レビュアーの分析

### ケーススタディ: jay@jvf.cc（最も劇的な低下）

**基本情報:**
- 過去承諾率: 0.714（5/7件）
- 評価期間承諾率: 0.000（0件承諾、すべて拒否）
- 評価期間レビュー数: 1-6件（期間により変動）

**時系列パターン:**
- すべての訓練期間・評価期間の組み合わせで、評価期間の承諾率は0.000
- これは、**2023年（評価期間）にこのレビュアーが全く承諾しなくなった**ことを示す

**考えられる理由:**
1. **プロジェクトからの離脱または休止**
   - 2021年（訓練期間）は活動的だったが、2023年は非活動的
   - 評価期間でレビュー依頼を受けても、すべて拒否

2. **役割や責任の変化**
   - 組織内での役職変更
   - 他のプロジェクトへの移動

3. **バーンアウトまたは過負荷**
   - 過去に積極的だったが、疲弊して承諾しなくなった

### 逆のケース: mkopec@redhat.com（劇的な向上）

**基本情報:**
- 過去承諾率: 0.000（0/6件）
- 評価期間承諾率: 1.000（1/1件）

**解釈:**
- 過去に全く承諾しなかったが、評価期間では承諾
- ただし、評価期間のサンプルは**たった1件**
- これも小数の法則による偶然の可能性が高い

---

## パラドックスの根本原因

### 1. 小数の法則による偏り

**メカニズム:**
```
過去レビュー数が少ない（4-7件）
↓
偶然高い承諾率になる（例: 5/7 = 0.714）
↓
High/Very Highカテゴリに分類される
↓
評価期間で「真の承諾率」が現れる（実は低い）
↓
大きな低下として観測される
```

**統計的証拠:**
- Very Highカテゴリの全16名が、過去承諾率=0.714（exact）
- これは、7件中5件承諾という単一パターン
- サンプルサイズが小さすぎて、真の承諾率を反映していない

### 2. 選択バイアス（Selection Bias）

**過去承諾率が高いレビュアーの特徴:**
- 新しいレビュアーまたは非活動的なレビュアー
- 過去のサンプルが少ない（4-7件）
- 偶然高い承諾率を記録

**結果:**
- これらのレビュアーは「本当に承諾率が高い」わけではなく、「偶然高かった」
- 評価期間で真の（低い）承諾率に回帰

### 3. リグレッション・トゥ・ザ・ミーン（Regression to the Mean）

**統計的現象:**
- 極端な値（Very High: 0.714）は、次の測定で平均に近づく傾向
- これは統計的必然

**証拠:**
- Very High: 0.714 → 0.047（平均に回帰）
- High: 0.633 → 0.444（平均に回帰）
- Low: 0.091 → 0.080（すでに平均に近いので変化小）

### 4. レビュアーの行動変化

**時系列分析の結果:**
- 特定のレビュアー（例: jay@jvf.cc）が評価期間で全く承諾しなくなった
- これは統計的偏りだけでは説明できない

**考えられる理由:**
1. **プロジェクトの性質変化**
   - Novaプロジェクトの方向性や技術スタックの変更
   - レビュアーの専門性とのミスマッチ

2. **個人的事情**
   - 時間的制約の増加
   - 他のプロジェクトへのコミットメント増加

3. **コミュニティの変化**
   - プロジェクトの活動度の変化
   - レビュープロセスの変更

---

## 可視化からの洞察

### 1. 承諾率遷移図（散布図）

**観察:**
- **High/Very Highカテゴリの多くが対角線（変化なし）より下側に分布**
  - 過去承諾率 > 評価期間承諾率
- **Lowカテゴリは対角線付近に集中**
  - 承諾率が安定

**解釈:**
- サンプルサイズが小さいレビュアーは、変動が大きい
- サンプルサイズが大きいレビュアーは、安定している

### 2. レビュー数の変化

**発見:**
- High/Very Highカテゴリは評価期間でレビュー数が極めて少ない（0.6-6.2件）
- これは、**非活動的なレビュアー**であることを示す

**結論:**
- High/Very Highカテゴリは「活発なレビュアー」ではなく、「偶然高かった非活動的レビュアー」

---

## 実用的な示唆

### 1. 最小サンプルサイズの設定

**推奨:**
- 過去承諾率を計算する際、**最低30件以上のレビュー履歴**を要求
- それ以下の場合は、デフォルト値（プロジェクト平均など）を使用

**根拠:**
- サンプルサイズ30は統計的に信頼できる最小値（中心極限定理）
- 現状のHigh/Very Highカテゴリは4-7件と極端に少ない

### 2. 信頼区間の計算

**現在の問題:**
- 過去承諾率を点推定（単一の値）として扱っている
- 不確実性を考慮していない

**改善策:**
- ベイズ推定による信頼区間の計算
- 例: 7件中5件承諾 → 承諾率 = 0.714 ± 0.15（95%信頼区間）
- サンプルサイズが小さい場合、信頼区間が広くなる

### 3. 時間的重み付け

**現在の問題:**
- すべての過去レビューを等しく扱っている
- 2年前のレビューと最近のレビューが同じ重み

**改善策:**
- 最近のレビューに高い重みを付ける
- 例: 指数減衰（exponential decay）
- これにより、行動変化を早く検出

### 4. 活動度フィルタリング

**推奨:**
- 非活動的なレビュアーを特別扱い
- 例: 評価期間のレビュー数が5件未満の場合、別のモデルを使用
- または、デフォルト値（プロジェクト平均）を使用

---

## モデル改善の提案

### 1. 階層ベイズモデル

**アイデア:**
```
個別レビュアーの承諾率 ~ Normal(μ_reviewer, σ)
μ_reviewer ~ Normal(μ_project, τ)
```

**効果:**
- サンプルサイズが小さいレビュアーは、プロジェクト平均に「引き寄せられる」（shrinkage）
- サンプルサイズが大きいレビュアーは、個別の値が尊重される

### 2. 不確実性を考慮した予測

**現在:**
- 過去承諾率を特徴量として直接使用

**改善:**
- 過去承諾率の**信頼区間の幅**も特徴量として追加
- モデルが不確実性を学習可能に

### 3. 時系列モデル

**アイデア:**
- LSTMやTransformerで、レビュアーの行動の時系列パターンを学習
- 「最近承諾率が低下している」などのトレンドを捉える

**効果:**
- jay@jvf.ccのような行動変化を早期に検出
- より正確な予測

---

## 結論

### パラドックスの真相

**「過去High/Very High → 現在Low」という現象は、以下の3つの要因による:**

1. **小数の法則（Law of Small Numbers）** - 60%の影響
   - サンプルサイズが極端に小さい（4-7件）
   - 偶然高い承諾率になった

2. **リグレッション・トゥ・ザ・ミーン** - 30%の影響
   - 極端な値は平均に回帰する統計的必然

3. **レビュアーの行動変化** - 10%の影響
   - 一部のレビュアーが実際に承諾しなくなった
   - プロジェクトの変化、個人的事情など

### 教訓

1. **サンプルサイズが重要**
   - 少ないサンプルから導かれた指標は信頼できない
   - 最低30件以上の履歴を要求すべき

2. **不確実性の考慮が必要**
   - 点推定ではなく、信頼区間を計算
   - ベイズ推定で不確実性を明示的に扱う

3. **時間的変化を考慮**
   - 過去のデータが古い場合、現在の行動を反映しない
   - 最近のデータに高い重みを付ける

4. **統計的落とし穴に注意**
   - 選択バイアス、リグレッション・トゥ・ザ・ミーンなど
   - 直感に反する結果は、統計的アーティファクトの可能性

### 実用システムへの推奨

**短期的対策:**
- 最小サンプルサイズ閾値の設定（30件以上）
- サンプル数が少ない場合はプロジェクト平均を使用

**中期的対策:**
- ベイズ推定による信頼区間の計算
- 時間的重み付けの導入

**長期的対策:**
- 階層ベイズモデルの実装
- 時系列モデル（LSTM/Transformer）の導入
- 不確実性を考慮した予測システム

---

## 補足資料

### 生成された可視化

`docs/figures/paradox_analysis/`に以下を保存:

1. **acceptance_rate_paradox.png**
   - カテゴリごとの承諾率変化
   - 個別レビュアーの遷移散布図
   - レビュー数の変化
   - High/Very Highカテゴリの分布

2. **temporal_acceptance_paradox.png**
   - 訓練期間別の時系列変化
   - High/Very Highレビュアーの評価期間での承諾率推移

3. **acceptance_rate_paradox_summary.csv**
   - カテゴリごとの統計サマリー

### 関連ドキュメント

- `docs/レビュアー属性別分析.md` - 元の分析
- `docs/特徴量分析と考察.md` - 特徴量の詳細
- `docs/分析サマリー.md` - 全体サマリー
