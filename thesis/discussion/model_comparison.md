# モデルごとのIRL vs RF比較

## データソース
- `outputs/rf_vs_irl_nova_summary/performance/irl/`
- `outputs/rf_vs_irl_nova_summary/performance/rf/`

---

## 0-3mモデル（短期学習）

| 評価期間 | 指標 | IRL | RF | 優位 | 差分 |
|----------|------|-----|-----|------|------|
| **0-3m** | AUC-ROC | 0.717 | 0.714 | IRL | +0.003 |
| | Precision | 0.565 | 0.524 | IRL | +0.041 |
| | Recall | 0.619 | 0.524 | IRL | +0.095 |
| | F1 | 0.591 | 0.524 | IRL | +0.067 |
| **3-6m** | AUC-ROC | 0.823 | 0.767 | **IRL** | **+0.056** |
| | Precision | 0.636 | 0.579 | IRL | +0.057 |
| | Recall | 0.778 | 0.611 | IRL | +0.167 |
| | F1 | 0.700 | 0.595 | **IRL** | **+0.105** |
| **6-9m** | AUC-ROC | 0.910 | 0.920 | RF | -0.010 |
| | Precision | 0.667 | 0.667 | 同等 | 0.000 |
| | Recall | 0.923 | 0.769 | IRL | +0.154 |
| | F1 | 0.774 | 0.714 | IRL | +0.060 |
| **9-12m** | AUC-ROC | 0.734 | 0.712 | IRL | +0.022 |
| | Precision | 0.611 | 0.600 | IRL | +0.011 |
| | Recall | 0.688 | 0.563 | IRL | +0.125 |
| | F1 | 0.647 | 0.581 | IRL | +0.066 |

### 0-3mモデルの特徴
- **全評価期間でIRLが優位または同等**
- 特に3-6m評価でIRLが大きく優位（AUC +0.056, F1 +0.105）
- IRLはRecallも高い（RFより+0.095〜+0.167）

---

## 3-6mモデル（中期学習）

| 評価期間 | 指標 | IRL | RF | 優位 | 差分 |
|----------|------|-----|-----|------|------|
| **3-6m** | AUC-ROC | 0.820 | 0.807 | IRL | +0.013 |
| | Precision | **0.769** | 0.386 | **IRL** | **+0.383** |
| | Recall | 0.556 | **0.944** | **RF** | -0.388 |
| | F1 | 0.645 | 0.548 | IRL | +0.097 |
| **6-9m** | AUC-ROC | 0.894 | 0.928 | RF | -0.034 |
| | Precision | **0.778** | 0.371 | **IRL** | **+0.407** |
| | Recall | 0.538 | **1.000** | **RF** | -0.462 |
| | F1 | 0.636 | 0.542 | IRL | +0.094 |
| **9-12m** | AUC-ROC | 0.802 | 0.750 | **IRL** | **+0.052** |
| | Precision | **0.778** | 0.424 | **IRL** | **+0.354** |
| | Recall | 0.438 | **0.875** | **RF** | -0.437 |
| | F1 | 0.560 | 0.571 | RF | -0.011 |

### 3-6mモデルの特徴
- **Precision: IRLが圧倒的に優位（+0.35〜+0.41）**
- **Recall: RFが圧倒的に優位（+0.39〜+0.46）**
- F1はIRLが優位（6-9m評価以外）
- **RFは「継続」と予測しすぎ → 偽陽性が多い**
- **IRLは慎重に予測 → 見落としはあるが精度は高い**

---

## 6-9mモデル（中長期学習）

| 評価期間 | 指標 | IRL | RF | 優位 | 差分 |
|----------|------|-----|-----|------|------|
| **6-9m** | AUC-ROC | 0.785 | 0.899 | **RF** | **-0.114** |
| | Precision | 0.500 | 0.565 | RF | -0.065 |
| | Recall | 0.692 | **1.000** | **RF** | -0.308 |
| | F1 | 0.581 | 0.722 | **RF** | **-0.141** |
| **9-12m** | AUC-ROC | 0.832 | 0.678 | **IRL** | **+0.154** |
| | Precision | 0.667 | 0.565 | IRL | +0.102 |
| | Recall | 0.750 | 0.813 | RF | -0.063 |
| | F1 | 0.706 | 0.667 | IRL | +0.039 |

### 6-9mモデルの特徴
- **6-9m評価: RFが優位**（AUC -0.114, F1 -0.141）
- **9-12m評価: IRLが優位**（AUC +0.154）
- RFは同期間評価で強いが、遠い期間では弱くなる
- IRLは遠い期間でも安定

---

## 9-12mモデル（長期学習）

| 評価期間 | 指標 | IRL | RF | 優位 | 差分 |
|----------|------|-----|-----|------|------|
| **9-12m** | AUC-ROC | 0.693 | 0.644 | **IRL** | **+0.049** |
| | Precision | 0.571 | 0.474 | IRL | +0.097 |
| | Recall | **1.000** | 0.563 | **IRL** | **+0.437** |
| | F1 | 0.727 | 0.514 | **IRL** | **+0.213** |

### 9-12mモデルの特徴
- **IRLが全指標で優位**
- 特にRecall（+0.437）とF1（+0.213）で大差
- 長期学習ではIRLの時系列パターン学習が効果的

---

## モデル別まとめ

| モデル | IRL優位 | RF優位 | 特徴 |
|--------|---------|--------|------|
| **0-3m** | ほぼ全て | - | IRLが安定して優位 |
| **3-6m** | Precision, F1 | Recall | RFは予測しすぎ（偽陽性多） |
| **6-9m** | 9-12m評価 | 6-9m評価 | 同期間はRF、遠い期間はIRL |
| **9-12m** | 全て | - | IRLが全指標で優位 |

---

## 考察への示唆

### なぜ3-6mモデルでRFのRecallが高いのか？

RFは3-6mモデルでRecall 0.94〜1.00と非常に高い。しかしPrecisionは0.37〜0.42と低い。

これは：
- RFが多くの開発者を「継続」と予測している
- 結果的に継続者はほぼ全員拾える（Recall高）
- しかし離脱者も「継続」と誤予測（偽陽性多 → Precision低）

**RFの問題**: 「量」に引っ張られて継続と予測しやすい

### なぜIRLはPrecisionが高いのか？

IRLは予測確率が0.45〜0.48程度で、閾値0.5では「離脱」と判定されやすい。
しかし、「継続」と予測した場合の精度は高い（Precision 0.77〜0.78）。

**IRLの特徴**: 慎重に予測するが、予測したものは当たりやすい

### モデル選択の指針

| 目的 | 推奨モデル | 理由 |
|------|-----------|------|
| 継続者を見落としたくない | RF (3-6m) | Recall高い |
| 予測の精度を重視 | IRL (3-6m) | Precision高い |
| バランス重視 | IRL (0-3m or 9-12m) | F1高い |
