# 考察のための深層分析

## なぜIRLはRFより優れた予測ができるのか？

単に「AUC-ROCが高い」ではなく、**具体的な開発者を例に、なぜ予測が分かれたのか**を分析する。

---

## 分析対象データ

`outputs/singleproject/irl_only_correct_analysis/irl_only_correct_detailed_summary.csv`

### 利用可能な特徴量

| 特徴量 | 意味 |
|--------|------|
| history_requests | 学習期間中のレビュー依頼数 |
| history_responses | 学習期間中の応答数 |
| history_rate | 学習期間中の承諾率 |
| reviewer_past_reviews_30d/90d/180d | 直近30/90/180日のレビュー数 |
| reviewer_tenure_days | プロジェクト在籍日数 |
| eval_requests | 評価期間の依頼数 |
| eval_responses | 評価期間の応答数（実際の結果） |

---

## 具体的な開発者分析

### Case 3: jichenjc@cn.ibm.com（RFが誤って「継続」と予測）

| 項目 | 値 |
|------|-----|
| パターン | 0-3m → 0-3m |
| **実際の結果** | **離脱（true_label=0）** |
| IRL予測 | 0.456 → **離脱と正しく予測** |
| RF予測 | 0.83 → **継続と誤予測** |

**特徴量:**
| 特徴量 | 値 | 解釈 |
|--------|-----|------|
| history_requests | 57件 | 多い |
| history_responses | 2件 | 非常に少ない |
| history_rate | 3.5% | 非常に低い |
| reviewer_past_reviews_30d | 2 | 最近の活動少ない |
| reviewer_tenure_days | 1740日 | ベテラン |

**なぜRFは失敗したか？**
- RFは「依頼数57件」という**量的な特徴**を重視
- 「依頼が多い＝活動的＝継続する」と判断
- **承諾率3.5%という時系列的なパターンを見落とした**

**なぜIRLは成功したか？**
- IRLは「依頼は多いが、ほとんど承諾していない」という**時系列パターン**を学習
- 報酬関数が「承諾率の低下」を離脱のシグナルとして捉えた

---

### Case 2: auniyal@redhat.com（RFが誤って「離脱」と予測）

| 項目 | 値 |
|------|-----|
| パターン | 0-3m → 0-3m |
| **実際の結果** | **継続（true_label=1）** |
| IRL予測 | 0.476 → **継続と正しく予測** |
| RF予測 | 0.42 → **離脱と誤予測** |

**特徴量:**
| 特徴量 | 値 | 解釈 |
|--------|-----|------|
| history_requests | 15件 | 少ない |
| history_responses | 3件 | 少ないが一定 |
| history_rate | 20% | 比較的高い |
| reviewer_past_reviews_30d | 152 | 最近は活発 |
| reviewer_tenure_days | 169日 | 新規参加者 |

**なぜRFは失敗したか？**
- RFは「依頼数15件」という**量的な特徴**を重視
- 「依頼が少ない＝非活動的＝離脱する」と判断
- **承諾率20%を維持しているパターンを見落とした**

**なぜIRLは成功したか？**
- IRLは「依頼は少ないが、安定して承諾している」という**時系列パターン**を学習
- 新規参加者でも承諾率が高ければ継続と判断

---

### Case 16: christian.rohmann@inovex.de（RF予測が極端に外れた例）

| 項目 | 値 |
|------|-----|
| パターン | 9-12m → 9-12m |
| **実際の結果** | **継続（true_label=1）** |
| IRL予測 | 0.475 → **継続と正しく予測** |
| RF予測 | **0.08** → **離脱と大きく誤予測** |

**特徴量:**
| 特徴量 | 値 | 解釈 |
|--------|-----|------|
| history_requests | 5件 | 非常に少ない |
| history_responses | 1件 | 少ない |
| history_rate | 20% | 高い |
| reviewer_past_reviews_30d | 12 | 活動あり |
| reviewer_tenure_days | 917日 | 中堅 |

**なぜRFは大きく失敗したか？**
- RF予測0.08は「ほぼ確実に離脱」という判断
- 「依頼数5件」を見て極端に低い予測
- **少数でも質の高い貢献をしているパターンを完全に見落とした**

---

## パターン分類と統計

### IRLのみ正解した16件の分類

| パターン | 定義 | 件数 | RF失敗理由 |
|----------|------|------|------------|
| **A: 多依頼・低承諾** | requests≥50, rate≤15% | 8件 | 量を過大評価 |
| **B: 少依頼・高承諾** | requests≤20, rate≥20% | 5件 | 量を過小評価 |
| C: その他 | 上記以外 | 3件 | - |

### パターンAの詳細統計

| 統計量 | 値 |
|--------|-----|
| 平均依頼数 | 217.6件 |
| 平均承諾率 | 5.4% |
| RF平均予測 | 0.64（継続と誤判定） |
| IRL平均予測 | 0.45（離脱と正しく判定） |
| **RF誤差** | **+0.64**（大きく外れ） |

### パターンBの詳細統計

| 統計量 | 値 |
|--------|-----|
| 平均依頼数 | 10.4件 |
| 平均承諾率 | 22.5% |
| RF平均予測 | 0.25（離脱と誤判定） |
| IRL平均予測 | 0.48（継続と正しく判定） |
| **RF誤差** | **-0.75**（大きく外れ） |

---

## 考察への反映

### セクション6.3の修正案

```
IRLのみが正しく予測した16件を分析した結果，RFの予測失敗には
明確なパターンがあることが明らかになった．

50%（8件）は，レビュー依頼数が50件以上と多いにも関わらず
承諾率が15%以下と低い開発者であった（表X, パターンA）．
例えば，開発者Xは依頼数57件であったが承諾率は3.5%であり，
RFは0.83と高い継続確率を予測したが実際には離脱した．
一方IRLは0.456と正しく離脱を予測した．
これは，RFが依頼数という量的特徴を重視する一方，
IRLは「依頼は多いが承諾率が低下している」という
時系列的なパターンを捉えることができたためと考えられる．

また，31%（5件）は，レビュー依頼数が20件以下と少ないが
承諾率が20%以上の開発者であった（表X, パターンB）．
特に開発者Yは依頼数5件であったが承諾率は20%であり，
RFは0.08とほぼ確実に離脱すると予測したが実際には継続した．
IRLは0.475と正しく継続を予測した．
これは，IRLが「依頼は少ないが安定して承諾している」という
質的なパターンを学習できたことを示唆する．

これらの結果から，RFは活動の量を重視するため，
量が多ければ質が低くても継続と判断し，
量が少なければ質が高くても離脱と判断する傾向がある．
一方IRLは，時系列的な活動パターンを学習することで，
量と質のバランスを考慮した予測が可能となっている．
```

---

## 追加で使えるデータ

### 開発者の時系列活動パターン

`outputs/singleproject/developer_data/*.csv` には各レビュー依頼ごとの詳細がある：

- `response_latency_days`: 応答までの日数
- `days_since_last_activity`: 前回活動からの経過日数
- `reviewer_assignment_load_7d/30d`: レビュー負荷

これを使えば「活動間隔が徐々に広がっている」「負荷が増加している」といった**動的なパターン**も分析可能。
